УДК 004.8:550.8

ПРИМЕНЕНИЕ МАШИННОГО ОБУЧЕНИЯ ДЛЯ ПРЕДСКАЗАНИЯ ЛИТОЛОГИИ ПО ДАННЫМ ГЕОФИЗИЧЕСКИХ ИССЛЕДОВАНИЙ СКВАЖИН

Иванов И.О.1

1

Иванов Игорь Олегович, студент БФ УУНиТ, г.Бирск, Россия
ivanov@example.ru

(пустая строка)

Аннотация

В работе представлена интеллектуальная система для автоматического определения типа литологии (горной породы) на основе геофизических параметров скважин с использованием методов машинного обучения. Разработана модель классификации на основе алгоритма Random Forest, обученная на данных 9 скважин (100793 записи). Система использует следующие входные параметры: гамма-каротаж (GR), объемная плотность (RHOB), нейтронная пористость (NPHI), глубокое сопротивление (RDEP) и идентификатор скважины (WELL_NAME). Модель способна классифицировать 8 типов литологии: песчаник, глина, мергель, известняк, доломит, уголь, ангидрит и прочие породы. Достигнута точность предсказания с F1-score (weighted) 0.9196. Разработано веб-приложение на платформе Streamlit для практического использования системы, обеспечивающее одиночное и пакетное предсказание, а также визуализацию результатов. Система может быть использована в образовательных целях для изучения применения машинного обучения в геологии и нефтегазовой отрасли.

Ключевые слова: машинное обучение, классификация, Random Forest, литология, геофизические исследования скважин, предсказание горных пород, веб-приложение, Streamlit

(пустая строка)

## Введение

Современные технологии машинного обучения находят широкое применение в различных областях науки и промышленности, включая геологию и нефтегазовую отрасль [1, 2]. Одной из важных задач в этой области является автоматическое определение типа литологии (горной породы) по данным геофизических исследований скважин [3, 4]. Традиционные методы интерпретации геофизических данных требуют значительного опыта специалистов и являются трудоемкими. Применение методов машинного обучения позволяет автоматизировать процесс классификации литологии, повысить точность и скорость анализа данных [5].

Целью данной работы является разработка интеллектуальной системы для предсказания типа литологии на основе геофизических параметров скважин с использованием алгоритмов машинного обучения и создание веб-приложения для практического использования системы.

## Материалы и методы

### Описание данных

Для обучения модели использовались данные геофизических исследований 9 скважин, содержащие 100793 записи. Исходные данные включали множество параметров, из которых для моделирования были отобраны наиболее информативные:

- **GR (Gamma Ray)** – гамма-каротаж, измеряет естественную радиоактивность пород (API units);
- **RHOB (Bulk Density)** – объемная плотность породы (g/cm³);
- **NPHI (Neutron Porosity)** – нейтронная пористость (v/v);
- **RDEP (Deep Resistivity)** – глубокое сопротивление (Ohm.m);
- **WELL_NAME** – идентификатор скважины (категориальный признак).

Целевая переменная представляла собой классификацию литологии по кодам FORCE 2020, включающую 11 исходных классов, которые были сгруппированы в 8 основных классов:

1. Песчаник (Sandstone) – код 30000
2. Глина (Shale) – код 65000
3. Мергель (Marl) – код 65030
4. Известняк (Limestone) – код 70000
5. Доломит (Dolomite) – код 70032
6. Уголь (Coal) – код 80000
7. Ангидрит (Anhydrite) – код 88000
8. Прочее (Other) – коды 74000, 86000, 90000, 99000

### Предобработка данных

На этапе предобработки данных были выполнены следующие операции:

1. **Объединение данных** из различных файлов с проверкой наличия необходимых столбцов.
2. **Удаление столбцов** с более чем 50% пропущенных значений (SP, RSHA).
3. **Обработка пропущенных значений**: столбцы RHOB, NPHI и DTC содержали небольшой процент пропусков (6.14%, 11.23% и 0.45% соответственно), которые были обработаны в процессе обучения модели.
4. **Преобразование типов данных**: категориальные признаки (FORCE_2020_LITHOFACIES_LITHOLOGY, WELL_NAME) были преобразованы в тип category.
5. **Анализ выбросов**: выявлены выбросы в признаках GR (1.01%), RHOB (0.77%), NPHI (0.11%) и RDEP (11.19%), которые были учтены при выборе методов масштабирования.

### Методы машинного обучения

Для решения задачи классификации литологии были протестированы следующие алгоритмы:

1. **Логистическая регрессия (Logistic Regression)** – базовый линейный классификатор
2. **K-ближайших соседей (K-Nearest Neighbors, KNN)** – метод на основе сходства
3. **Дерево решений (Decision Tree)** – интерпретируемый алгоритм
4. **Случайный лес (Random Forest)** – ансамблевый метод на основе деревьев решений [6, 8]
5. **Градиентный бустинг (Gradient Boosting)** – ансамблевый метод с последовательным улучшением [7, 10]

Предобработка признаков включала:
- **RobustScaler** для числовых признаков (GR, RHOB, NPHI, RDEP) – устойчив к выбросам [9]
- **OneHotEncoder** для категориального признака WELL_NAME [9]

Все модели были объединены в pipeline с использованием библиотеки scikit-learn [6, 9] для обеспечения воспроизводимости и удобства развертывания.

### Оптимизация гиперпараметров

Для выбора оптимальной модели и гиперпараметров использовался метод **RandomizedSearchCV** с кросс-валидацией (StratifiedKFold, 5 фолдов). В качестве метрики оптимизации использовался F1-score (weighted), учитывающий дисбаланс классов в данных.

Лучшие результаты показал алгоритм **Random Forest** со следующими гиперпараметрами:
- n_estimators: 200
- max_depth: None (без ограничения глубины)
- min_samples_split: 2
- min_samples_leaf: 1
- max_features: log2
- bootstrap: True

## Результаты

### Производительность модели

Обученная модель Random Forest достигла следующих показателей:
- **F1-score (weighted)**: 0.9196
- Время обучения: 8 минут 26 секунд

Высокий показатель F1-score свидетельствует о хорошей способности модели различать различные типы литологии с учетом дисбаланса классов в данных.

### Разработка веб-приложения

Для практического использования разработанной модели было создано веб-приложение на платформе **Streamlit**, предоставляющее следующие возможности:

1. **Одиночное предсказание**: пользователь может ввести параметры скважины через интерактивную форму и получить предсказание типа литологии с вероятностями для всех классов.

2. **Пакетное предсказание**: возможность загрузки CSV-файла с данными множества записей и получение предсказаний для всех записей одновременно с возможностью скачивания результатов.

3. **Визуализация**: интерактивные графики, показывающие распределение вероятностей по классам и влияние различных параметров на предсказание.

4. **Информационная панель**: отображение информации о модели, ее гиперпараметрах и производительности.

Приложение имеет интуитивно понятный интерфейс, не требует специальных знаний в программировании и может быть использовано как специалистами-геологами, так и студентами для обучения.

## Обсуждение

Разработанная система демонстрирует эффективность применения методов машинного обучения для решения задачи классификации литологии [1, 3, 4]. Использование алгоритма Random Forest позволило достичь высокой точности предсказания благодаря способности модели обрабатывать нелинейные зависимости между признаками и устойчивости к выбросам в данных [6, 8, 9].

Важным аспектом работы является правильная предобработка данных, включающая выбор информативных признаков, обработку пропущенных значений и масштабирование [2, 5]. Использование RobustScaler оказалось предпочтительным по сравнению со стандартным StandardScaler из-за наличия выбросов в данных, особенно в признаке RDEP.

Включение категориального признака WELL_NAME в модель позволило учесть специфику различных скважин, что улучшило качество предсказаний. Аналогичный подход применяется в работах по применению машинного обучения для литологического расчленения геологических моделей [3].

Разработанное веб-приложение делает систему доступной для практического использования и может служить образовательным инструментом для изучения применения машинного обучения в геологии [1].

## Заключение

В работе успешно разработана интеллектуальная система для предсказания литологии на основе геофизических параметров скважин. Модель Random Forest показала высокую точность классификации (F1-score 0.9196) и способность различать 8 типов горных пород.

Созданное веб-приложение на платформе Streamlit обеспечивает удобный интерфейс для использования системы в практических и образовательных целях. Система может быть применена в нефтегазовой отрасли для автоматизации процесса интерпретации геофизических данных и в образовательных учреждениях для демонстрации возможностей машинного обучения в геологии.

Перспективы дальнейшего развития системы включают:
- Расширение набора признаков для улучшения точности
- Использование более сложных алгоритмов (например, нейронных сетей)
- Добавление визуализации геологических разрезов
- Интеграция с базами данных геофизических исследований

## Список литературы

1. Петрушкин В.А. Методы и технологии искусственного интеллекта в геолого-геофизических исследованиях / В.А. Петрушкин // Геоинформатика. – 2025. – № 3. – С. 96-106.

2. Вахитова Г.Р. Прогноз петрофизических свойств горных пород с использованием алгоритмов машинного обучения / Г.Р. Вахитова, Э.Д. Прайя, Р.И. Рюков // Нефтепромысловое дело. – 2024. – № 4 (664). – С. 27-33.

3. Жидков Р.Ю. Применение технологий машинного обучения для литологического расчленения трёхмерных геологических моделей / Р.Ю. Жидков, В.С. Рекун, Н.А. Абакумова, Н.Н. Ракитина, Г.А. Лесников // Сергеевские чтения. Региональная инженерная геология и геоэкология : материалы годичной сессии Научного совета РАН по проблемам геоэкологии, инженерной геологии и гидрогеологии. Москва, 2024. – С. 364-368.

4. Шиверский Г.В. Возможности машинного обучения при прогнозе свойств пород коллекторов / Г.В. Шиверский, А.А. Кочнев // Проблемы разработки месторождений углеводородных и рудных полезных ископаемых. – 2023. – Т. 1. – С. 106-111.

5. Аль-Реяши Х.А.А.А. Использование передовых методов сейсмической интерпретации для оценки нефтегазоносности в мелководных морских бассейнах / Х.А.А.А. Аль-Реяши, А.О.А. Аль-Беадуни, С.А.Г. Аль-Агбари, А.Α.Α.Τ. Аль-Гаади // Московский экономический журнал. – 2024. – Т. 9, № 6. – С. 223-239.

6. Феннер М.Э. Машинное обучение с помощью Python для всех / М.Э. Феннер. — Москва : Эксмо, 2024. — 672 с.

7. Принс С.Д. Погружение в машинное и глубокое обучение / С.Д. Принс. — Москва : Эксмо, 2025. — 608 с.

8. Практическое машинное обучение с помощью Python : руководство для начинающих. — Москва : Прогресс книга, 2025. — 512 с.

9. Мюллер А. Введение в машинное обучение с помощью Python : руководство для специалистов по работе с данными / А. Мюллер, С. Гвидо. — Москва : Вильямс, 2023. — 480 с.

10. Рашка С. Python и машинное обучение : машинное и глубокое обучение с использованием Python, scikit-learn и TensorFlow 2 / С. Рашка, В. Мирджалили. — Москва : ДМК Пресс, 2021. — 768 с.

11. Streamlit Documentation [Электронный ресурс]. – Режим доступа: https://docs.streamlit.io/ (дата обращения: 15.11.2025).

12. FORCE 2020 Machine Learning Contest [Электронный ресурс]. – Режим доступа: https://github.com/bolgebrygg/Force-2020-Machine-Learning-competition (дата обращения: 15.11.2025).

Ivanov I.O.
APPLICATION OF MACHINE LEARNING FOR LITHOLOGY PREDICTION FROM WELL LOGGING DATA

Ivanov Igor Olegovich, student of CF UUNiT, Birsk, Russia
ivanov@example.ru

Annotation

The paper presents an intelligent system for automatic determination of lithology (rock type) based on well logging parameters using machine learning methods. A classification model based on the Random Forest algorithm was developed, trained on data from 9 wells (100793 records). The system uses the following input parameters: gamma ray (GR), bulk density (RHOB), neutron porosity (NPHI), deep resistivity (RDEP) and well identifier (WELL_NAME). The model can classify 8 types of lithology: sandstone, shale, marl, limestone, dolomite, coal, anhydrite and other rocks. A prediction accuracy with F1-score (weighted) of 0.9196 was achieved. A web application on the Streamlit platform was developed for practical use of the system, providing single and batch prediction, as well as visualization of results. The system can be used for educational purposes to study the application of machine learning in geology and the oil and gas industry.

Keywords: machine learning, classification, Random Forest, lithology, well logging, rock prediction, web application, Streamlit
